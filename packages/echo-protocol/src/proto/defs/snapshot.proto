//
// Copyright 2020 DXOS.org
//

syntax = "proto3";

package dxos.echo.snapshot;

import "echo.proto";

message ItemSnapshot {
  string itemId = 1;

  string itemType = 2;
  string modelType = 3;
  string modelVersion = 4;

  string parentId = 5;

  repeated ModelMutation mutations = 6;
}

message ModelMutation {
  bytes mutation = 1;
  ModelMutationMeta meta = 2;
}

message ModelMutationMeta {
  bytes feedKey = 1;
  int32 seq = 2;
  bytes memberKey = 3;
}

message DatabaseSnapshot {
  repeated ItemSnapshot items = 1;
}

message HaloStateSnapshot {
  repeated dxos.CredentialsMessage messages = 1;
}

message PartySnapshot {
  Timeframe timeframe = 1;

  HaloStateSnapshot halo = 2;

  DatabaseSnapshot database = 3;
}
